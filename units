Function GetFormattedPriceUnits(TextLine As String, Keyword As String) As String
    Dim Pos As Long
    Dim FirstNumber As Double
    Dim SecondNumber As Double
    Dim Parts As Variant
    Dim i As Integer
    
    ' Find the position of the keyword in the text line
    Pos = InStr(TextLine, Keyword)
    
    If Pos > 0 Then
        ' Split the text line into an array to extract numbers
        Parts = Split(Mid(TextLine, Pos + Len(Keyword)))
        
        ' Loop through the parts to find the first and second numbers
        For i = LBound(Parts) To UBound(Parts)
            If IsNumeric(Parts(i)) Then
                If FirstNumber = 0 Then
                    FirstNumber = CDbl(Parts(i)) ' First number (units)
                    ' Exit if the first number is zero
                    If FirstNumber = 0 Then
                        GetFormattedPriceUnits = ""
                        Exit Function
                    End If
                Else
                    SecondNumber = CDbl(Parts(i)) ' Second number (price)
                    Exit For ' Once both numbers are found, exit loop
                End If
            End If
        Next i
        
        ' Format the result as second number/first number
        If FirstNumber <> 0 And SecondNumber <> 0 Then
            GetFormattedPriceUnits = SecondNumber & "/" & FirstNumber
        Else
            GetFormattedPriceUnits = ""
        End If
    Else
        GetFormattedPriceUnits = ""
    End If
End Function


If InStr(TextLine, "approved open order") > 0 Then
    Dim formattedPriceUnits As String
    formattedPriceUnits = GetFormattedPriceUnits(TextLine, "approved open order")
    
    ' Based on CurrentSecurity, import into the appropriate column
    If CurrentSecurity = "S1" Then
        Cells(9, 2).Value = formattedPriceUnits ' Column B, Row 9
    ElseIf CurrentSecurity = "S2" Then
        Cells(9, 3).Value = formattedPriceUnits ' Column C, Row 9
    ElseIf CurrentSecurity = "S3" Then
        Cells(9, 4).Value = formattedPriceUnits ' Column D, Row 9
    ElseIf CurrentSecurity = "S4" Then
        Cells(9, 5).Value = formattedPriceUnits ' Column E, Row 9
    End If
End If