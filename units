Sub ParseOpenOrder()
    Dim FilePath As String
    Dim TextLine As String
    Dim Units As Double
    Dim Price As Double
    Dim unitPrice As String
    Dim FileNumber As Integer
    Dim FoundPos As Long
    Dim Parts() As String
    Dim i As Integer
    
    ' Set file path
    FilePath = "C:\Path\To\Your\TextFile.txt" ' Change to your actual file path
    
    ' Open the file
    FileNumber = FreeFile
    Open FilePath For Input As FileNumber
    
    ' Loop through each line of the text file
    Do While Not EOF(FileNumber)
        Line Input #FileNumber, TextLine
        
        ' Look for the keyword "open order"
        FoundPos = InStr(1, TextLine, "open order", vbTextCompare)
        
        If FoundPos > 0 Then
            ' Split the line into parts to find numbers
            Parts = Split(TextLine, " ")
            
            ' Loop through the parts to find the numbers
            For i = 0 To UBound(Parts)
                If IsNumeric(Parts(i)) Then
                    ' First number is Units
                    Units = CDbl(Parts(i))
                    
                    ' Exit loop if Units is 0
                    If Units = 0 Then
                        Close FileNumber
                        Exit Sub
                    End If
                    
                    ' Continue to find the next number (Price)
                    If i + 1 <= UBound(Parts) And IsNumeric(Parts(i + 1)) Then
                        Price = CDbl(Parts(i + 1))
                        
                        ' Store the price / units as a string
                        unitPrice = Price & " / " & Units
                        
                        ' You can now use the unitPrice variable as needed
                        ' Example: Debug.Print unitPrice
                        
                        ' Exit after finding the first valid "open order"
                        Close FileNumber
                        Exit Sub
                    End If
                End If
            Next i
        End If
    Loop
    
    ' Close the file
    Close FileNumber
End Sub




Sub ParseOpenOrder()
    Dim FilePath As String
    Dim FileNum As Integer
    Dim LineOfText As String
    Dim Units As Double
    Dim Price As Double
    Dim finalUnits As Double
    Dim finalPrice As Double
    Dim unitPrice As String
    Dim KeyWord As String
    Dim Position As Long
    Dim TextAfterKeyword As String
    Dim Values() As String
    
    ' Set the keyword and file path
    KeyWord = "approved open order"
    FilePath = "C:\path\to\your\file.txt" ' <-- Change this to your file path
    FileNum = FreeFile
    
    ' Open the text file
    Open FilePath For Input As FileNum
    
    ' Loop through each line in the file
    Do Until EOF(FileNum)
        Line Input #FileNum, LineOfText
        
        ' Check if the line contains the keyword
        Position = InStr(1, LineOfText, KeyWord, vbTextCompare)
        If Position > 0 Then
            ' Extract the part of the line after the keyword
            TextAfterKeyword = Mid(LineOfText, Position + Len(KeyWord))
            
            ' Split the remaining line by spaces (or any other delimiter if needed)
            Values = Split(Application.Trim(TextAfterKeyword), " ")
            
            ' Check if the first value after the keyword is numeric (Units)
            If IsNumeric(Values(0)) Then
                Units = CDbl(Values(0))
                
                ' If Units is 0, exit the loop
                If Units = 0 Then
                    Exit Do
                End If
                
                ' Check if the next value is numeric (Price)
                If UBound(Values) > 0 And IsNumeric(Values(1)) Then
                    Price = CDbl(Values(1))
                    
                    ' Save Units and Price into finalUnits and finalPrice
                    finalUnits = Units
                    finalPrice = Price
                    
                    ' Calculate unitPrice as "Price / Units"
                    unitPrice = finalPrice & " / " & finalUnits
                    
                    ' Exit the loop after saving the values
                    Exit Do
                End If
            End If
        End If
    Loop
    
    ' Close the file
    Close FileNum
    
    ' Display the results (for testing purposes)
    MsgBox "finalUnits: " & finalUnits & vbCrLf & "finalPrice: " & finalPrice & vbCrLf & "unitPrice: " & unitPrice
End Sub