Sub ParseTextFileForSecurities()
    Dim FilePath As String
    Dim TextLine As String
    Dim Securities As Variant
    Dim i As Integer
    Dim FileNum As Integer
    Dim Pos As Integer
    Dim AdmissionsValue As String
    Dim WithdrawalsValue As String
    Dim CurrentSecurity As String
    Dim SecurityFound As Boolean
    Dim KeyWord As String
    Dim ParsedNumber As String
    Dim ColumnOffset As Integer
    
    ' List of securities (S1, S2, S3, S4)
    Securities = Array("S1", "S2", "S3", "S4")
    
    ' Specify the file path to the text file
    FilePath = "C:\path\to\your\file.txt"
    
    ' Open the text file for reading
    FileNum = FreeFile
    Open FilePath For Input As FileNum
    
    ' Loop through each security
    For i = LBound(Securities) To UBound(Securities)
        CurrentSecurity = Securities(i)
        SecurityFound = False
        AdmissionsValue = ""
        WithdrawalsValue = ""
        
        ' Loop through the file line by line
        Do While Not EOF(FileNum)
            Line Input #FileNum, TextLine
            
            ' Check if the line contains the current security
            If InStr(TextLine, CurrentSecurity) > 0 Then
                SecurityFound = True ' Security found
                
            ' Once the security is found, look for "Total Admissions" or "Total Withdrawals"
            ElseIf SecurityFound Then
                ' Check for "Total Admissions"
                If InStr(TextLine, "Total Admissions") > 0 Then
                    Pos = InStr(TextLine, "Total Admissions")
                    ' Parse the second number after the keyword
                    AdmissionsValue = GetSecondNumber(TextLine, Pos + Len("Total Admissions"))
                
                ' Check for "Total Withdrawals"
                ElseIf InStr(TextLine, "Total Withdrawals") > 0 Then
                    Pos = InStr(TextLine, "Total Withdrawals")
                    ' Parse the second number after the keyword
                    WithdrawalsValue = GetSecondNumber(TextLine, Pos + Len("Total Withdrawals"))
                End If
                
                ' Move to the next security once both admissions and withdrawals are found
                If AdmissionsValue <> "" And WithdrawalsValue <> "" Then Exit Do
            End If
        Loop
        
        ' Write the values to the appropriate cells in the Excel sheet
        If AdmissionsValue <> "" Then
            Cells(7, i + 2).Value = AdmissionsValue ' Row 7, columns B:E
        End If
        
        If WithdrawalsValue <> "" Then
            Cells(8, i + 2).Value = WithdrawalsValue ' Row 8, columns B:E
        End If
        
        ' Reset file pointer to the beginning for next security
        Seek FileNum, 1
    Next i
    
    ' Close the file
    Close FileNum
End Sub

' Helper function to extract the second number from the text line
Function GetSecondNumber(ByVal TextLine As String, ByVal StartPos As Integer) As String
    Dim Parts As Variant
    Dim i As Integer
    Dim Counter As Integer
    
    ' Split the text line into parts (numbers and words)
    Parts = Split(Mid(TextLine, StartPos))
    Counter = 0
    
    ' Loop through the parts and return the second number found
    For i = LBound(Parts) To UBound(Parts)
        If IsNumeric(Parts(i)) Then
            Counter = Counter + 1
            If Counter = 2 Then
                GetSecondNumber = Parts(i)
                Exit Function
            End If
        End If
    Next i
    
    ' If no second number is found, return an empty string
    GetSecondNumber = ""
End Function